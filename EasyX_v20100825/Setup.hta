<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type" /><title>EasyX v20100825 安装向导</title><script type="text/javascript">var w=503,h=365;window.resizeTo(w,h);window.moveTo((window.screen.width-w)>>1,(window.screen.height-h)>>1);</script><HTA:APPLICATION ID="oHTA" APPLICATIONNAME="EasyX 安装向导" BORDER="dialog" CONTEXTMENU="no" INNERBORDER="no" MAXIMIZEBUTTON="no" MINIMIZEBUTTON="yes" SCROLL="no" SELECTION="no" SINGLEINSTANCE="yes" VERSION="20100825" /><style type="text/css">html,body{height:100%;width:100%;margin:0px;font-size:12px}body{position:relative;overflow:hidden;background-color:#ECE9D8;}.main{height:10%;padding:10px 16px}#welcome .main{padding:0px}#wel_l{float:left;width:136px;height:504px;color:#ACA899;background:#000080;font-size:48px;writing-mode:tb-rl;font-family:Arial;padding:14px;}#wel_r{padding:14px 16px;height:500px;background:#fff;}#wel_b{width:100%;height:42px;line-height:41px;position:absolute;bottom:0px;left:0px;background-color:#ECE9D8;border-top:1px solid #ACA899;}#wel_b #wel_b2{border-top:1px solid #FFF;text-align:right;}.head{width:100%;background-color:white;border-bottom:1px solid #FFF;}.head .head2{height:33px;padding:10px 16px;border-bottom:1px solid #ACA899;}.foot{width:100%;height:41px;line-height:41px;position:absolute;bottom:0px;left:0px;text-align:right;}#idelist td{vertical-align:middle;border-bottom:1px solid #888888;}#btnPrev,#btnNext,#btnClose{width:72px}#btnClose{margin:0px 14px}</style></head><script type="text/javascript">var files=[{"path":"include\\","name":"graphics.h"},{"path":"lib\\","name":"graphics.lib"},{"path":"lib\\","name":"graphicsu.lib"},{"path":"lib\\","name":"graphicsw.lib"},{"path":"lib\\","name":"graphicswu.lib"}];var groups=[{"name":"Visual C++ 6.0",	"Check":"CheckVC6(0)",		"path_h":"", "path_lib":"", "files_h":[0], "files_lib":[1,2]},{"name":"Visual C++ 2008","Check":"CheckVC2008(1)",	"path_h":"", "path_lib":"", "files_h":[0], "files_lib":[3,4]},{"name":"Visual C++ 2010","Check":"CheckVC2010(2)",	"path_h":"", "path_lib":"", "files_h":[0], "files_lib":[3,4]}];</script><body><div id="welcome"><div class="main"><div id="wel_l">EasyX</div><div id="wel_r"><h1 style="font-size:16px">欢迎使用“EasyX v20100825”安装向导</h1>这个向导将帮助您安装 EasyX 库至指定开发环境中。该系统目前支持 Visual C++ 6 / 2008 / 2010。<br /><br />EasyX 库为 C/C++ 提供了简单的绘图接口，可以帮助您快速编写图形程序。<br /><br />单击 [下一步] 继续。</div></div><div id="wel_b"><div id="wel_b2"><input id="btnNext" onclick="step_setup()" type="button" value="下一步 &gt;" disabled="disabled" />&nbsp;<input id="btnClose" onclick="window.close()" type="button" value="取消" /></div></div></div><div id="setup" style="display:none"><div class="head"><div class="head2"><b>执行安装</b><br /><span>　　请针对您所用的开发平台，选择安装或卸载。</span></div></div><div class="foot"><input id="btnPrev" onclick="step_welcome()" type="button" value="&lt; 上一步" />&nbsp;<input id="btnClose" onclick="window.close()" type="button" value="关闭" /><div style="overflow:hidden;margin:8px;height:0px;width:96.8%; border-top:1px solid #ACA899; border-bottom:1px solid #FFFFFF;position:absolute;top:-10px;left:0px;"></div><label disabled="disabled" style="line-height:14px;padding:0px 4px;background-color:#ECE9D8;position:absolute;top:-9px;left:8px;">EasyX Install System v1.01</label></div><div class="main">在下表中找到您所用的的开发平台，点击右侧的“安装”将 EasyX 库安装至该开发平台。或点击右侧的“卸载”将 EasyX 库从该开发平台移除。<div style="height:140px;width:100%;overflow:auto;margin:10px;"><table style="width:440px" style="height:auto"><tbody id="idelist"></tbody></table></div>如果您希望手动安装 EasyX，请参见帮助文件。</div></div><script type="text/javascript">function $(objID){return document.getElementById(objID);}function RegRead(key){var WshShell = new ActiveXObject("WScript.Shell");var s="";try{s=WshShell.RegRead(key);}catch(e){}return s;}function step_welcome(){$("welcome").style.display="block";$("setup").style.display="none";}function step_setup(){$("welcome").style.display="none";$("setup").style.display="block";initidelist();}function CheckBase(id){var fso=new ActiveXObject("Scripting.FileSystemObject");if((!fso.FolderExists(groups[id].path_h)) || (!fso.FolderExists(groups[id].path_lib))) groups[id].path_h=groups[id].path_lib="";}function CheckVC6(id){s=RegRead("HKCU\\Software\\Microsoft\\DevStudio\\6.0\\Directories\\Install Dirs");if(s.length>0){s=s.replace(/Common\\MSDev98\\Bin$/,"");groups[id].path_h=s+"VC98\\include\\";groups[id].path_lib=s+"VC98\\lib\\";}CheckBase(id);}function CheckVC2008(id){s=RegRead("HKLM\\Software\\Microsoft\\VisualStudio\\SxS\\VC7\\9.0");if(s.length>0){groups[id].path_h=s+"include\\";groups[id].path_lib=s+"lib\\";}CheckBase(id);}function CheckVC2010(id){s=RegRead("HKLM\\Software\\Microsoft\\VisualStudio\\SxS\\VC7\\10.0");if(s.length>0){groups[id].path_h=s+"include\\";groups[id].path_lib=s+"lib\\";}CheckBase(id);}function Install(id){var fso=new ActiveXObject("Scripting.FileSystemObject");var err="";for(i=0; i<groups[id].files_h.length; i++){try{fso.CopyFile(files[groups[id].files_h[i]].path+files[groups[id].files_h[i]].name, groups[id].path_h+files[groups[id].files_h[i]].name, true);}catch(e){err+="“"+groups[id].path_h+files[groups[id].files_h[i]].name+"”复制失败，原因："+e.description+"\r\n";}}for(i=0; i<groups[id].files_lib.length; i++){try{fso.CopyFile(files[groups[id].files_lib[i]].path+files[groups[id].files_lib[i]].name, groups[id].path_lib+files[groups[id].files_lib[i]].name, true);}catch(e){err+="“"+groups[id].path_lib+files[groups[id].files_lib[i]].name+"”复制失败，原因："+e.description+"\r\n";}}if(err.length>0) alert("以下文件安装失败：\r\n"+err);else alert("安装成功！");}function Uninstall(id){var fso=new ActiveXObject("Scripting.FileSystemObject");var err="";var f;for(i=0; i<groups[id].files_h.length; i++){f=groups[id].path_h+files[groups[id].files_h[i]].name;if(fso.FileExists(f)){try{fso.DeleteFile(f);}catch(e){err+="“"+f+"”删除失败，原因："+e.description+"\r\n";}}}for(i=0; i<groups[id].files_lib.length; i++){f=groups[id].path_lib+files[groups[id].files_lib[i]].name;if(fso.FileExists(f)){try{fso.DeleteFile(f);}catch(e){err+="“"+f+"”删除失败，原因："+e.description+"\r\n";}}}if(err.length>0) alert("以下文件删除失败：\r\n"+err);else alert("卸载完成！");}function initidelist(){var tb = document.getElementById("idelist");while(tb.hasChildNodes()) tb.removeChild(tb.lastChild);for (i=0; i<groups.length; i++){tr=document.createElement("tr");	tr.id="ide"+i;td=document.createElement("td");	td.id="ide"+i+"_Name";td.innerHTML=groups[i].name;td.noWrap=true;tr.appendChild(td);td=document.createElement("td");	td.id="ide"+i+"_Cfg";eval(groups[i].Check);if((groups[i].path_h.length>0) && (groups[i].path_lib.length>0)) td.innerHTML="头文件路径 "+groups[i].path_h+"<br/>库文件路径 "+groups[i].path_lib;else td.innerHTML="未检测到";tr.appendChild(td);td=document.createElement("td");	td.id="ide"+i+"_Opt";if((groups[i].path_h.length>0) && (groups[i].path_lib.length>0)) td.innerHTML="<input onclick='Install("+i+")' type='button' value='安装' /> <input onclick='Uninstall("+i+")' type='button' value='卸载' />";else td.innerHTML="<input disabled='disabled' type='button' value='安装' /> <input disabled='disabled' type='button' value='卸载' />";td.noWrap=true;tr.appendChild(td);$("idelist").appendChild(tr);	}}$("btnNext").disabled="";</script></body></html>